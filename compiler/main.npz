import std;
import iofile;

const lexerPkg = import "./lexer/lexer.npz";
const parserPkg = import "./parser/parser.npz";
const formatPkg = import "./util/formatting.npz";
const resPkg = import "./parser/result.npz";

func main(args) {
    if (std.length(args) == 0) {
        std.println("Expected file path.");
        return;
    }
        
    const fp = iofile.openFile(args[0], "r");
    const src = iofile.readFile(fp);
    const filename = formatPkg.getFilename(args[0]);
    iofile.closeFile(fp);

    const lexer = lexerPkg.Lexer(filename, src);
    let hasError = !lexer.lex();
    if (hasError) {
        lexer.printError();
        return;
    }

    // lexer.printTokens();

    std.println(std.asString(resPkg.Error.InvalidSyntax(
        filename, src, 40, 45, "Your code looks dumb."
    )));
}

std.main(main);
